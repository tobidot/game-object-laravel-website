parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"tVXf":[function(require,module,exports) {
"use strict";function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";throw new Error(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.throw_expression=void 0,exports.throw_expression=e;
},{}],"4NPu":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.TreeElementNotFoundException=void 0;var e=function(e){function o(t){var r=e.call(this,t)||this;return r.name=o.name,Object.setPrototypeOf(r,o.prototype),r}return t(o,e),o}(Error);exports.TreeElementNotFoundException=e;
},{}],"1XIB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Vector2=void 0;var t=function(){function t(t,i){void 0===t&&(t=0),void 0===i&&(i=0),"object"==typeof t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=i)}return t.prototype.set=function(t,i){return void 0===i&&(i=0),"object"==typeof t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=i),this},t.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.mul=function(t){return this.x*=t,this.y*=t,this},t.prototype.divide=function(t){return this.x/=t,this.y/=t,this},t.prototype.len2=function(){return this.x*this.x+this.y*this.y},t.prototype.len=function(){return Math.sqrt(this.len2())},t.prototype.set_magnitude=function(t){var i=this.len();return this.x=this.x/i*t,this.y=this.y/i*t,this},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.cross=function(i){return new t(this.x*i.y,this.y*i.x)},t.prototype.get_unsigned=function(){return new t(Math.abs(this.x),Math.abs(this.y))},t.prototype.cpy=function(){return new t(this.x,this.y)},t.prototype.normalize=function(){var t=this.len();return t<1e-6?this:(this.x/=t,this.y/=t,this)},t.prototype.get_projection_of=function(t){var i=this.dot(t)/this.len2();return this.cpy().mul(i)},t.prototype.is_null_vector=function(){return Math.abs(this.x)<.001&&Math.abs(this.y)<.001},t.prototype.get_angle=function(){return(Math.atan2(this.y,this.x)+Math.PI/2)%(2*Math.PI)},t.prototype.rotate_radians_clockwise=function(t){var i=Math.sin(t),s=Math.cos(t),e=-i*this.y+s*this.x,n=i*this.x+s*this.y;return this.y=n,this.x=e,this},t.prototype.rotate_right_angles_clockwise=function(t){if(void 0===t&&(t=1),t<1)return this;var i=this.y;return this.y=-this.x,this.x=i,this.rotate_right_angles_clockwise(t-1)},t.from_angle=function(i,s){return void 0===s&&(s=1),new t(Math.cos(i)*s,Math.sin(i)*s)},t.RIGHT=new t(1,0),t.LEFT=new t(-1,0),t.UP=new t(0,-1),t.DOWN=new t(0,1),t}();exports.Vector2=t;
},{}],"Vjic":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Rect=void 0;var t=require("./Vector2"),e=function(){function e(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.w=i,this.h=r}return Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),e.prototype.get_left=function(){return this.x},Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),e.prototype.get_top=function(){return this.y},Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.w},enumerable:!1,configurable:!0}),e.prototype.get_right=function(){return this.x+this.w},e.prototype.get_bottom=function(){return this.y+this.h},Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.h},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.w},enumerable:!1,configurable:!0}),e.prototype.get_width=function(){return this.w},Object.defineProperty(e.prototype,"height",{get:function(){return this.h},enumerable:!1,configurable:!0}),e.prototype.get_height=function(){return this.h},e.prototype.cpy=function(){return new e(this.x,this.y,this.w,this.h)},e.prototype.set=function(t,e,i,r){return"object"==typeof t?(this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h):(this.x=t,this.y=e,void 0!==i&&(this.w=i),void 0!==r&&(this.h=r)),this},e.prototype.get_area=function(){return this.w*this.h},Object.defineProperty(e.prototype,"center",{get:function(){return new t.Vector2(this.x+this.w/2,this.y+this.h/2)},set:function(t){this.x=t.x-this.w/2,this.y=t.y-this.h/2},enumerable:!1,configurable:!0}),e.prototype.set_center=function(t){return this.center=t,this},e.prototype.expand_to=function(t){if(this.contains(t))return this;var e=Math.min(this.x,t.x),i=Math.min(this.y,t.y),r=Math.max(this.get_right(),t.x),n=Math.max(this.get_bottom(),t.y);return this.set(e,i,r-e,n-i)},e.prototype.overlaps_with=function(t){return e.overlap(this,t)},e.prototype.is_within=function(t){return e.is_within(this,t)},e.prototype.contains=function(t,i){if("object"==typeof t)return e.contains(this,t);if("number"!=typeof i)throw new Error("Unexpected type error");return e.contains(this,{x:t,y:i})},e.prototype.lerp=function(t,e){var i=1-e;return this.x=this.x*i+t.x*e,this.y=this.y*i+t.y*e,this.w=this.w*i+t.w*e,this.h=this.h*i+t.h*e,this},e.prototype.get_corners=function(){return[{x:this.left,y:this.top},{x:this.right,y:this.top},{x:this.right,y:this.bottom},{x:this.left,y:this.bottom}]},e.contains=function(t,e){return e.x>=t.x&&e.y>=t.y&&e.x<=t.x+t.w&&e.y<=t.y+t.h},e.contains_exclusive=function(t,e){return e.x>t.x&&e.y>t.y&&e.x<t.x+t.w&&e.y<t.y+t.h},e.overlap=function(t,e){var i=t.x+t.w>e.x&&t.x<=e.x||e.x+e.w>t.x&&e.x<=t.x,r=t.y+t.h>e.y&&t.y<=e.y||e.y+e.h>t.y&&e.y<=t.y;return i&&r},e.is_within=function(t,e){var i=t.x>e.x&&t.x+t.w<e.x+e.w,r=t.y>e.y&&t.y+t.h<e.y+e.h;return i&&r},e}();exports.Rect=e;
},{"./Vector2":"1XIB"}],"MPel":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.QuadTreeBranch=exports.QuadTree=void 0;var e=require("./exceptions/TreeElementNotFoundException"),n=require("../geometries/Rect"),r=function(){function t(t){this.root_branch=new o(t.x,t.y,t.w,t.h)}return t.prototype.pick=function(t){return this.root_branch.pick(t)},t.prototype.add=function(t){n.Rect.is_within(t,this.root_branch)?this.root_branch.add(t):(this.elevate_root_branch(),this.add(t))},t.prototype.elevate_root_branch=function(){var t=this.root_branch,e={x:t.x-t.w,y:t.y-t.h,w:2*t.w,h:2*t.h},n={x:e.x,y:e.y,w:2*e.w,h:2*e.h};this.wrap_root_node_in_node_with_rect(e,2),this.wrap_root_node_in_node_with_rect(n,0)},t.prototype.wrap_root_node_in_node_with_rect=function(t,e){var n=new o(t.x,t.y,t.w,t.h);if(n.create_child_branches(),!n.child_branch_nodes)throw new Error;n.child_branch_nodes[e]=this.root_branch,this.root_branch=n},t.prototype.change_element=function(t,e){this.remove(t),t.x=e.x,t.y=e.y,t.w=e.w,t.h=e.h,this.add(t)},t.prototype.remove=function(t){if(!this.root_branch.remove(t))throw new e.TreeElementNotFoundException},t.prototype.is_empty=function(){return this.root_branch.is_empty()},t.prototype.clear=function(){this.root_branch.clear(8)},t}();exports.QuadTree=r;var o=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.child_branch_nodes=null,t.elements=[],t}return t(r,e),r.prototype.add=function(t){if(null===this.child_branch_nodes)return this.elements.push(t),this.create_child_branches_if_necessary(),!0;var e=this.child_branch_nodes.filter(function(e){return e.overlaps_with(t)},[]);if(0===e.length)throw Error("Inconsistent Result");return 1===e.length?e[0].add(t):this.elements.push(t),!0},r.prototype.readd_own_elements=function(){var t=this;this.elements.splice(0).forEach(function(e){t.add(e)})},r.prototype.create_child_branches_if_necessary=function(){this.elements.length<10||(this.create_child_branches(),this.readd_own_elements())},r.prototype.create_child_branches=function(){var t=this.w/2,e=this.h/2;this.child_branch_nodes=[new r(this.x,this.y,t,e),new r(this.x+t,this.y,t,e),new r(this.x+t,this.y+e,t,e),new r(this.x,this.y+e,t,e)]},r.prototype.pick=function(t,e){if(void 0===e&&(e=[]),!this.overlaps_with(t))return e;if(e.push.apply(e,this.elements.filter(function(e){return n.Rect.overlap(t,e)})),null===this.child_branch_nodes)return e;if(this.is_within(t))return this.pick_all(e);for(var r=0,o=this.child_branch_nodes;r<o.length;r++){o[r].pick(t,e)}return e},r.prototype.pick_all=function(t){if(t.push.apply(t,this.elements),null===this.child_branch_nodes)return t;for(var e=0,n=this.child_branch_nodes;e<n.length;e++){n[e].pick_all(t)}return t},r.prototype.remove=function(t){var e=this.elements.indexOf(t);if(-1!==e)return this.elements.splice(e,1),!0;if(null===this.child_branch_nodes)return!1;for(var n=0,r=this.child_branch_nodes;n<r.length;n++){if(r[n].remove(t))return!0}return!1},r.prototype.is_empty=function(){if(!this.is_self_empty())return!1;if(null===this.child_branch_nodes)return!0;for(var t=0,e=this.child_branch_nodes;t<e.length;t++){if(!e[t].is_empty())return!1}return!0},r.prototype.is_self_empty=function(){return 0===this.elements.length},r.prototype.clear=function(t){this.elements.splice(0),this.child_branch_nodes&&(t<=0?this.child_branch_nodes=null:this.child_branch_nodes.forEach(function(e){e.clear(t-1)}))},r}(n.Rect);exports.QuadTreeBranch=o;
},{"./exceptions/TreeElementNotFoundException":"4NPu","../geometries/Rect":"Vjic"}],"jLya":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Game=void 0;var n=require("./utils/flow-control"),s=require("@game.object/ts-game-toolbox/src/trees/QuadTree"),i=require("@game.object/ts-game-toolbox/src/geometries/Rect"),r=require("@game.object/ts-game-toolbox/src/geometries/Vector2"),a=10,h=function(){function e(){var o,r,a=this;t(this,e),this.ants=[],this.pheromones=[],this.pheromone_tree=new s.QuadTree(new i.Rect(0,0,800,600)),this.foods=[],this.food_tree=new s.QuadTree(new i.Rect(0,0,800,600));var h=null!==(o=document.getElementById("app"))&&void 0!==o?o:n.throw_expression("Canvas not found");if(!(h instanceof HTMLCanvasElement))throw new Error("Canvas not found");this.canvas=h,this.context=null!==(r=h.getContext("2d"))&&void 0!==r?r:n.throw_expression("Context not found"),this.canvas.addEventListener("click",function(t){var e=(t.clientX-a.canvas.offsetLeft)/a.canvas.clientWidth*a.canvas.width,o=(t.clientY-a.canvas.offsetTop)/a.canvas.clientHeight*a.canvas.height;a.on_click(e,o)});var u=document.getElementById("controls");if(!(u instanceof HTMLFormElement))throw new Error("Controls not found");this.controls_form=u;var c=u.querySelector("[name=show-ants]");if(!(c instanceof HTMLInputElement))throw new Error("Controls not found");this.controls_show_ants=c;var l=u.querySelector("[name=show-foods]");if(!(l instanceof HTMLInputElement))throw new Error("Controls not found");this.controls_show_foods=l;var f=u.querySelector("[name=show-pheromones]");if(!(f instanceof HTMLInputElement))throw new Error("Controls not found");this.controls_show_pheromones=f;var d=u.querySelector("[name=simulation-speed]");if(!(d instanceof HTMLInputElement))throw new Error("Controls not found");this.controls_simulation_speed=d;var m=u.querySelector("[name=simulation-steps]");if(!(m instanceof HTMLInputElement))throw new Error("Controls not found");this.controls_simulation_steps=m}return o(e,[{key:"init",value:function(){this.ants=[];for(var t=0;t<150;++t){var e=new l(this),o=400+100*Math.random(),n=300+100*Math.random();e.x=o,e.y=n,this.ants.push(e)}this.foods=[];for(var s=0;s<15;++s)for(var i=700*Math.random()+50,r=300*Math.random()+50,a=0;a<150;++a){var h=i+50*Math.random(),u=r+50*Math.random();this.add_food(h,u)}}},{key:"on_click",value:function(t,e){for(var o=t,n=e,s=0;s<150;++s){var i=o+50*Math.random(),r=n+50*Math.random();this.add_food(i,r)}}},{key:"run",value:function(){var t=this;this.init();requestAnimationFrame(function e(){for(var o=0;o<parseInt(t.controls_simulation_speed.value);o++)t.update(parseInt(t.controls_simulation_steps.value)/60);requestAnimationFrame(e)})}},{key:"update",value:function(t){var e=this;this.draw(),this.ants.forEach(function(e){e.update(t)}),this.pheromones=this.pheromones.filter(function(o){return o.update(t),o.intensity>0||(e.pheromone_tree.remove(o),!1)})}},{key:"draw",value:function(){var t=this;this.context.clearRect(0,0,800,600),this.controls_show_pheromones.checked&&this.pheromones.forEach(function(e){var o=Math.min(255,Math.max(0,Math.floor(255*e.intensity/20)));t.context.fillStyle=(e.type?"#8800ff":"#0088ff")+("00"+o.toString(16)).substr(-2,2),t.context.fillRect(e.x-1,e.y-1,3,3)}),this.controls_show_ants.checked&&(this.context.beginPath(),this.context.strokeStyle="red",this.ants.forEach(function(e){t.context.moveTo(e.x+5,e.y),t.context.ellipse(e.x,e.y,5,5,0,0,2*Math.PI)}),this.context.stroke()),this.controls_show_foods.checked&&(this.context.beginPath(),this.context.fillStyle="green",this.foods.forEach(function(e){t.context.moveTo(e.x+4,e.y),t.context.ellipse(e.x,e.y,4,4,0,0,2*Math.PI)}),this.context.fill())}},{key:"add_food",value:function(t,e){var o=new f;o.x=t-o.h/2,o.y=e-o.w/2,this.foods.push(o),this.food_tree.add(o)}},{key:"drop_pheromone",value:function(t,e,o){var n=new d;n.x=t.x,n.y=t.y,n.type=e,n.intensity=o,this.pheromones.push(n),this.pheromone_tree.add(n)}}]),e}();function u(t,e,o){return new i.Rect(t.x-e/2,t.y-o/2,e,o)}exports.Game=h;var c,l=function(){function e(o){t(this,e),this.game=o,this.x=400,this.y=300,this.vx=0,this.vy=0,this.transport=null,this.cooldown=0,this.time_until_random=0,this.pheromone_drop_intensity=0}return o(e,[{key:"update",value:function(t){var e=this;this.x+=this.vx*t*25,this.y+=this.vy*t*25;var o=this.x-400,n=this.y-300;o*o+n*n<2500&&(this.pheromone_drop_intensity=a,null!==this.transport&&(this.game.foods=this.game.foods.filter(function(t){return t!==e.transport}),this.transport=null,this.vx*=-1,this.vy*=-1));var s=Math.PI/4,i=function(t){return function(e){return t.cpy().sub(e).len2()<100}},h=Math.atan2(this.vy,this.vx),l=r.Vector2.from_angle(h-s,20),f=r.Vector2.from_angle(h,20),d=r.Vector2.from_angle(h+s,20),m=l.cpy().add(this),p=f.cpy().add(this),v=d.cpy().add(this),y=this.game.pheromone_tree.pick(u(m,10,10)).filter(i(m)),_=this.game.pheromone_tree.pick(u(p,10,10)).filter(i(p)),x=this.game.pheromone_tree.pick(u(v,10,10)).filter(i(v)),w=this.evaluate_pheromons(y),M=this.evaluate_pheromons(_),g=this.evaluate_pheromons(x);this.vx+=(Math.random()-.5-Math.abs(o)*o/144e4)/25,this.vy+=(Math.random()-.5-Math.abs(n)*n/144e4)/25,M>g&&M>w&&(this.vx+=f.x/10,this.vy+=f.y/10,this.time_until_random=1),w>M&&w>g&&(this.vx+=l.x/10,this.vy+=l.y/10,this.time_until_random=1),g>w&&g>M&&(this.vx+=d.x/10,this.vy+=d.y/10,this.time_until_random=1),g===w&&w===M&&(this.time_until_random-=t,this.time_until_random<0&&(this.vx+=(Math.random()-.5-Math.abs(o)*o/144e4)/5,this.vy+=(Math.random()-.5-Math.abs(n)*n/144e4)/5));var k=Math.sqrt(this.vx*this.vx+this.vy*this.vy);this.vx/=k,this.vy/=k,null!==this.transport?this.update_transport_food(t):this.update_pickup_food(t),this.cooldown-=t,this.pheromone_drop_intensity*=.995,this.cooldown<0&&(this.cooldown=.5,this.game.drop_pheromone({x:this.x,y:this.y},null===this.transport?c.HOME:c.FOOD,2*this.pheromone_drop_intensity))}},{key:"evaluate_pheromons",value:function(t){var e=this;return t.reduce(function(t,o){switch(o.type){case c.FOOD:return t+(null===e.transport?o.intensity:0);case c.HOME:return t+(null===e.transport?0:o.intensity)}},0)}},{key:"move_random",value:function(){}},{key:"update_transport_food",value:function(t){this.transport&&(this.transport.x=this.x,this.transport.y=this.y)}},{key:"update_pickup_food",value:function(t){var e=this.game.food_tree.pick({x:this.x,y:this.y,w:8,h:8}).filter(function(t){return null===t.transported_by});e.length>0&&(this.transport=e[0],e[0].transported_by=this,this.game.food_tree.remove(e[0]),this.vx*=-1,this.vy*=-1,this.pheromone_drop_intensity=a)}}]),e}(),f=function e(){t(this,e),this.w=5,this.h=5,this.x=0,this.y=0,this.transported_by=null},d=function(){function e(){t(this,e),this.w=4,this.h=4,this.x=0,this.y=0,this.type=c.HOME,this.intensity=20}return o(e,[{key:"update",value:function(t){this.intensity-=t}}]),e}();!function(t){t[t.HOME=0]="HOME",t[t.FOOD=1]="FOOD"}(c||(c={}));
},{"./utils/flow-control":"tVXf","@game.object/ts-game-toolbox/src/trees/QuadTree":"MPel","@game.object/ts-game-toolbox/src/geometries/Rect":"Vjic","@game.object/ts-game-toolbox/src/geometries/Vector2":"1XIB"}],"LQOA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./Game");(new e.Game).run();
},{"./Game":"jLya"}]},{},["LQOA"], null)
//# sourceMappingURL=ts.19a6dd6f.js.map